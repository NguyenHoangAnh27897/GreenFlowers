@model IQueryable<GreenFlowers.Models.GF_Product>
@using GreenFlowers.Models
@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
    GreenFlowersEntities db = new GreenFlowersEntities();
    var lst = db.GF_Product.ToList();
}

<div class="breadcrumb-area gray-bg">
    <div class="container">
        <div class="breadcrumb-content">
            <ul>
                <li><a href="/home/index">Home</a></li>
                <li class="active">Chi tiết sản phẩm </li>
            </ul>
        </div>
    </div>
</div>
<div class="product-details pt-75 pb-65">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-12">
                <div class="product-details-img">
                    <img class="zoompro" src="/Images/product/avatar/@Model.FirstOrDefault().Avatar" data-zoom-image="/Images/product/avatar/@Model.FirstOrDefault().Avatar" alt="zoom" />
                    <div id="gallery" class="mt-20 product-dec-slider owl-carousel">
                        <a data-image="~/Images/product-details/product-detalis-l1.jpg" data-zoom-image="~/Images/product-details/product-detalis-bl1.jpg">
                            <img src="~/Images/product-details/product-detalis-s1.jpg" alt="">
                        </a>
                        <a data-image="~/Images/product-details/product-detalis-l2.jpg" data-zoom-image="~/Images/product-details/product-detalis-bl2.jpg">
                            <img src="~/Images/product-details/product-detalis-s2.jpg" alt="">
                        </a>
                        <a data-image="~/Images/product-details/product-detalis-l3.jpg" data-zoom-image="~/Images/product-details/product-detalis-bl3.jpg">
                            <img src="~/Images/product-details/product-detalis-s3.jpg" alt="">
                        </a>
                        <a data-image="~/Images/product-details/product-detalis-l4.jpg" data-zoom-image="~/Images/product-details/product-detalis-bl4.jpg">
                            <img src="~/Images/product-details/product-detalis-s4.jpg" alt="">
                        </a>
                        <a data-image="~/Images/product-details/product-detalis-l5.jpg" data-zoom-image="~/Images/product-details/product-detalis-bl5.jpg">
                            <img src="~/Images/product-details/product-detalis-s5.jpg" alt="">
                        </a>
                        <a data-image="~/Images/product-details/product-detalis-l2.jpg" data-zoom-image="~/Images/product-details/product-detalis-bl2.jpg">
                            <img src="~/Images/product-details/product-detalis-s2.jpg" alt="">
                        </a>
                    </div>
                    <span>-29%</span>
                </div>
            </div>
            <div class="col-lg-6 col-md-12">
                <div class="product-details-content">
                    <h4>@Model.FirstOrDefault().ProductName</h4>
                    <div class="rating-review">
                        <div class="pro-dec-rating">
                            <i class="ion-android-star-outline theme-star"></i>
                            <i class="ion-android-star-outline theme-star"></i>
                            <i class="ion-android-star-outline theme-star"></i>
                            <i class="ion-android-star-outline theme-star"></i>
                            <i class="ion-android-star-outline"></i>
                        </div>
                        <div class="pro-dec-review">
                            <ul>
                                <li>32 Reviews </li>
                                <li> Add Your Reviews</li>
                            </ul>
                        </div>
                    </div>
                    <span>@string.Format("{0:n0}", Model.FirstOrDefault().Price) VNĐ</span>
                    <div class="in-stock">
                        <p>Available: <span>In stock</span></p>
                    </div>
                    <p>@Html.Raw(Model.FirstOrDefault().Description.Substring(0,30))</p>
                    <div class="pro-dec-feature">
                        <ul>
                            <li><input type="checkbox"> Protection Plan: <span> 2 year  $4.99</span></li>
                            <li><input type="checkbox"> Remote Holder: <span> $9.99</span></li>
                            <li><input type="checkbox"> Koral Alexa Voice Remote Case: <span> Red  $16.99</span></li>
                            <li><input type="checkbox"> Amazon Basics HD Antenna: <span>25 Mile  $14.99</span></li>
                        </ul>
                    </div>
                    <div class="quality-add-to-cart">
                        <div class="quality">
                            <label>Qty:</label>
                            <input class="cart-plus-minus-box" type="text" name="qtybutton" value="02">
                        </div>
                        <div class="shop-list-cart-wishlist">
                            <a href="" title="Add To Cart" class="btn-cart">
                                <i class="icon-handbag"></i>
                            </a>
                            <a title="Wishlist" href="#">
                                <i class="icon-heart"></i>
                            </a>
                        </div>
                    </div>
                    <div class="pro-dec-categories">
                        <ul>
                            <li class="categories-title">Categories:</li>
                            <li><a href="#">Birthday,</a></li>
                            <li><a href="#"> Bouquets, </a></li>
                            <li><a href="#">Custom Orders,</a></li>
                            <li><a href="#">Home Decor,</a></li>
                            <li><a href="#">Weddings, </a></li>
                        </ul>
                    </div>
                    <div class="pro-dec-categories">
                        <ul>
                            <li class="categories-title">Tags: </li>
                            <li><a href="#"> Bouquet,</a></li>
                            <li><a href="#"> Event, </a></li>
                            <li><a href="#"> Gift,</a></li>
                            <li><a href="#"> Joy,</a></li>
                            <li><a href="#"> Love </a></li>
                        </ul>
                    </div>
                    <div class="pro-dec-social">
                        <ul>
                            <li><a class="tweet" href="#"><i class="ion-social-twitter"></i> Tweet</a></li>
                            <li><a class="share" href="#"><i class="ion-social-facebook"></i> Share</a></li>
                            <li><a class="google" href="#"><i class="ion-social-googleplus-outline"></i> Google+</a></li>
                            <li><a class="pinterest" href="#"><i class="ion-social-pinterest"></i> Pinterest</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="description-review-area pb-70">
    <div class="container">
        <div class="description-review-wrapper">
            <div class="description-review-topbar nav text-center">
                <a class="active" data-toggle="tab" href="#des-details1">Description</a>
                <a data-toggle="tab" href="#des-details2">Tags</a>
                <a data-toggle="tab" href="#des-details3">Review</a>
            </div>
            <div class="tab-content description-review-bottom">
                <div id="des-details1" class="tab-pane active">
                    <div class="product-description-wrapper">
                        <p>@Html.Raw(Model.FirstOrDefault().Description)</p>
                        <ul>
                            <li>-  Typi non habent claritatem insitam</li>
                            <li>-  Est usus legentis in iis qui facit eorum claritatem. </li>
                            <li>-  Investigationes demonstraverunt lectores legere me lius quod ii legunt saepius.</li>
                            <li>-  Claritas est etiam processus dynamicus, qui sequitur mutationem consuetudium lectorum.</li>
                        </ul>
                    </div>
                </div>
                <div id="des-details2" class="tab-pane">
                    <div class="product-anotherinfo-wrapper">
                        <ul>
                            <li><span>Tags:</span></li>
                            <li><a href="#"> bouquet,</a></li>
                            <li><a href="#"> event,</a></li>
                            <li><a href="#"> gift,</a></li>
                            <li><a href="#"> joy,</a></li>
                            <li><a href="#"> love ,</a></li>
                            <li><a href="#"> special</a></li>
                        </ul>
                    </div>
                </div>
                <div id="des-details3" class="tab-pane">
                    <div class="rattings-wrapper">
                        <div class="sin-rattings">
                            <div class="star-author-all">
                                <div class="ratting-star f-left">
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <span>(5)</span>
                                </div>
                                <div class="ratting-author f-right">
                                    <h3>tayeb rayed</h3>
                                    <span>12:24</span>
                                    <span>9 March 2018</span>
                                </div>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Utenim ad minim veniam, quis nost rud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Utenim ad minim veniam, quis nost.</p>
                        </div>
                        <div class="sin-rattings">
                            <div class="star-author-all">
                                <div class="ratting-star f-left">
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <i class="ion-star theme-color"></i>
                                    <span>(5)</span>
                                </div>
                                <div class="ratting-author f-right">
                                    <h3>farhana shuvo</h3>
                                    <span>12:24</span>
                                    <span>9 March 2018</span>
                                </div>
                            </div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Utenim ad minim veniam, quis nost rud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Utenim ad minim veniam, quis nost.</p>
                        </div>
                    </div>
                    <div class="ratting-form-wrapper">
                        <h3>Add your Comments :</h3>
                        <div class="ratting-form">
                            <form action="#">
                                <div class="star-box">
                                    <h2>Rating:</h2>
                                    <div class="ratting-star">
                                        <i class="ion-star theme-color"></i>
                                        <i class="ion-star theme-color"></i>
                                        <i class="ion-star theme-color"></i>
                                        <i class="ion-star theme-color"></i>
                                        <i class="ion-star"></i>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="rating-form-style mb-20">
                                            <input placeholder="Name" type="text">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="rating-form-style mb-20">
                                            <input placeholder="Email" type="text">
                                        </div>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="rating-form-style form-submit">
                                            <textarea name="message" placeholder="Message"></textarea>
                                            <input type="submit" value="add review">
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="product-area pb-70">
    <div class="container">
        <div class="product-top-bar section-border mb-35">
            <div class="section-title-wrap">
                <h3 class="section-title section-bg-white">Related Products</h3>
            </div>
        </div>
        <div class="featured-product-active hot-flower owl-carousel product-nav">
            @foreach (var item in lst)
            {
                <div class="product-wrapper">
                    <div class="product-img">
                        <a href="/product/detail/@item.ID">
                            <img alt="" src="~/Images/product/avatar/@item.Avatar">
                        </a>
                        @*<span>-30%</span>*@
                        <div class="product-action">
                            <a class="action-wishlist" href="#" title="Wishlist">
                                <i class="icon-heart"></i>
                            </a>
                            <a class="action-compare" href="/product/detail/@item.ID" data-target="#exampleModal" data-toggle="modal" title="Quick View">
                                <i class="icon-magnifier-add"></i>
                            </a>
                        </div>
                    </div>
                    <div class="product-content text-center">
                        <h4>
                            <a href="/product/detail/@item.ID">@item.ProductName </a>
                        </h4>
                        <div class="product-price-wrapper">
                            <span>Giá: @string.Format("{0:n0}", item.Price) VNĐ</span>
                            @*<span class="product-price-old">$120.00 </span>*@
                        </div>
                    </div>
                </div>
            }

        </div>
    </div>
</div>

<script type="text/javascript">
    var orderArr = [];
    const price = @Model.FirstOrDefault().Price;
    const proName = document.querySelector('div.product-details-content > h4').innerHTML;
    const avatar = document.querySelector('div.product-details-img > img').getAttribute('src');
    const avr = avatar.slice(avatar.lastIndexOf('/')).replace(/\//,'');

    $('a.btn-cart').click((e) => {
        e.preventDefault();
        const qty = document.querySelector('input[name=qtybutton]').value;
        const $ul = $('div.shopping-cart-content > ul');
        var dataOrder = JSON.parse(localStorage.getItem('order'));
        if(dataOrder != null) {
            orderArr = dataOrder;
            loStorage($ul, orderArr, qty);
        } else {
            loStorage($ul, orderArr, qty);
        }
    });

    var loStorage = ($ul, orderArr, qty) => {
        var obj = {};
        obj.date = new Date().toDateString();
        obj.ProductName = proName;
        obj.Price = price;
        obj.Avatar = avr;
        obj.Qty = qty;
        orderArr.push(obj);
        if (typeof (Storage) !== "undefined") {
            console.log(orderArr);
            localStorage.setItem('order', JSON.stringify(orderArr));
        } else {
            console.log("dont have local storage");
        }
        $ul.prepend(myLi(obj,(orderArr.length-1)));
        document.querySelector('span.count-style').innerText = (orderArr.length);
    }

    var myLi = (data,i) => {
        var $li = `<li class="single-shopping-cart" data-order="${i}">
                    <div class="shopping-cart-img">
                        <a href="#"><img alt="" src="Images/cart/${data.Avatar}"></a>
                    </div>
                    <div class="shopping-cart-title">
                        <h4><a href="#">${data.ProductName} </a></h4>
                        <h6>Qty: ${data.Qty}</h6>
                        <span>${data.Price}</span>
                    </div>
                    <div class="shopping-cart-delete">
                        <a class="delete" href=""><i class="ion ion-close"></i></a>
                    </div>
                </li>`;
        return $li;
    }

</script>
